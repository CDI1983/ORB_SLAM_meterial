# 第二章作业

### 2.1  在什么条件下，***x*** 有解且唯一？

在方程组的系数矩阵的秩与方程组增广矩阵的秩相等且均等于方程组中未知数个数的时候，方程组有唯一解。

### 2.2  高斯消元法的原理是什么？

通过用初等行变换将增广矩阵化为阶梯矩阵，再进一步化为行最简形式，然后通过回带求解线性方程组的解。

### 2.3  QR 分解的原理是什么？

利用２个正交矩阵的乘积一定是正交矩阵，正交矩阵的逆矩阵也是正交矩阵的特点，对正交矩阵进行多次分解，相乘。具体是将任意一个满秩矩阵可以分解成一个列向量正交矩阵 Q 与一个上三角矩阵 R 的积，即 A = Q R 。以施密特正交化方法为例，原理是利用正交投影的思想，将矩阵每个列作为一个基本单元，再将其转化为正交的基向量与在这个基向量上的投影长度的积。

### 2.4  Cholesky 分解的原理是什么？

将一个对称正定的矩阵表示成一个下三角矩阵L和其转置的乘积的分解。它要求矩阵的所有特征值必须大于零，故分解的下三角的对角元也是大于零的。如果矩阵A为n阶对称正定矩阵，则存在一个对角元素为正数的下三角实矩阵L，使得：A=LL^T，当限定L的对角元素为正时，这种分解是唯一的，称为Cholesky分解。

引申：

改进的Cholesky 分解，大体思想不变，只是具体计算方法略微不同，A=LD，其中 L 为下三角矩阵，D为对角线矩阵。

### 2.5  编程实现 ***A*** 为 100 *×* 100 随机矩阵时，用 QR 和 Cholesky 分解求 ***x*** 的程序。你可以参考本次课用到的 useEigen 例程。

思路：由于不可能任何矩阵都能化为正定矩阵，但任何实矩阵都可以分解为半正定矩阵和正交矩阵之积。所以本题应该使用 ldlt(半正定矩阵) 计算，但 Cholesky 分解需要正定矩阵，所以这里可能有一些出入。由于发现这个问题时间比较晚了，已经是周日晚上，所以仓促改了下，不知道对不对，待助教答疑时帮忙解答下。

![无标题666.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598666.png)

### 3.1  什么是正定矩阵和半正定矩阵？

正定矩阵：给定一个n乘n的实对称矩阵 A，若对于任意长度为 n 的非零向量 x，有 x 的转置乘以 A 再乘以x恒大于0，则矩阵 A 是一个正定矩阵。

半正定矩阵：给定一个n乘n的实对称矩阵 A，若对于任意长度为 n 的非零向量 x，有 x 的转置乘以 A 再乘以 x 恒大于等于0，则矩阵 A 是一个半正定矩阵。

### 3.2  对于方阵 ***A***，它的特征值是什么？特征向量是什么？特征值一定是实数吗？如何计算一个矩阵的特征值？

定义：给定一个n阶的矩阵 A ，若存在实数 λ 及 n 维非零向量 x ，使得 A x = λ x ，则称 λ 是矩阵 A 的特征值，x 是 A 属于特征值 λ 的特征向量。

        为直观的理解这两个概念，下面将结合矩阵变换的几何意义来介绍这两个概念。对于一个n维的向量 x 来说，如果我们给它乘上一个 n 阶的方阵 A ，得到 Ax 。从几何角度来说，是对向量 x 进行了一个线性变换。变换之后得到的向量 y （也就是 Ax ）和原向量 x 的方向和长度都发生了改变。

        但对于一个特定的矩阵 A 来说，总存在一些特定方向的向量 x，使得 Ax 和 x 的方向没有发生变化，只是长度发生了变化。我们令这个长度发生的变化当做是系数 λ ，那么对于这样的向量 x 就称为是矩阵 A 的特征向量，λ 就是这个特征向量对应的特殊值，也就是矩阵 A 的特征值。

特征值不一定是实数，也可能是虚数，只有实对称矩阵的特征值才保证是实数，复矩阵的特征值也可能有实数。

求n阶矩阵 A 的特征值的基本方法：

根据定义可改写为关系式 ( A − λ E ) x = 0，E为单位矩阵。 若要求 x 有非零解，即求齐次线性方程组 ( A − λ E ) x = 0 有非零解的值 λ 。即要求行列式 det( A − λ E ) x = 0。解此行列式获得的 λ 值即为矩阵 A **的特征值。将此值回代入原式求得相应的 x ，即为输入这个行列式的特征向量。

### 3.3  什么是矩阵的相似性？相似性反映了什么几何意义？

设 A，B 都是n阶矩阵，若存在可逆矩阵 P，使 P^(-1)AP=B，则称 B 是 A 的相似矩阵, 并称矩阵 A 与 B 相似，记为 A~B。对进行运算称为对进行相似变换，称可逆矩阵为相似变换矩阵。

相似的矩阵是同一个线性变换在不同基坐标系下的的不同描述。

同一个特定运动，但坐标系改变的话这个运动的描述函数就会不一样，如果这个函数可用矩阵等价替代的话，一个坐标系就对应着一个矩阵，因此这些矩阵就不同，但这些矩阵必有关系，这个关系就是相似。

### 3.4  矩阵一定能对角化吗？什么样的矩阵能保证对角化？不能对角化的矩阵能够形成什么样的形式（Jordan 标准形）？

只有主对角线上含有非零元素的矩阵称为对角矩阵。矩阵不一定能对角化。

如果一个矩阵与一个对角矩阵相似，我们就称这个矩阵可经相似变换对角化，简称可对角化；即n阶方阵可对角化的充分必要条件是它有n个线性无关的特征向量。

不能对角化的矩阵一定具有多重特征值，对于不能对角化的矩阵也希望找到某种标准形式，使之尽量接近对角化的形式。Jodan型矩阵为上双对角矩阵，其上对角线的元素为1或0。这种标准型总能够实现，但不一定数值稳定。该标准型是一组“几乎对角的”矩阵。

### 3.5  奇异值分解（SVD）是什么意思？

答：奇异值分解（SVD）是一种用于将矩阵归约成其组成部分的矩阵分解方法，以使后面的某些矩阵计算更简单。X=UΣV∗,X=UΣV∗,其中 U 是m×m阶酉矩阵；Σ 是m×n阶非负实数对角矩阵；而V*，即 V 的共轭转置，是n×n阶酉矩阵。这样的分解就称作 X 的奇异值分解。

### 3.6  矩阵的伪逆是什么意思（Pseudo inverse）？莫尔——彭多斯逆是如何定义的？怎么计算一个矩阵的伪逆？

伪逆矩阵是逆矩阵的广义形式。由于奇异矩阵或非方阵的矩阵不存在逆矩阵，但可以用函数 pinv(A)求其伪逆矩阵。基本语法为 X=pinv(A), X=pinv(A,tol), 其中 tol 为误差：max(size(A))*norm(A)*eps。函数返回一个与 A 的转置矩阵 A' 同型的矩阵 X，并且满足：AXA=A, XAX=X。此时，称矩阵 X 为矩阵 A 的伪逆，也称为广义逆矩阵。pinv(A)具有 inv(A) 的部分特性，但不与 inv(A) 完全等同。

如果矩阵 B 满足以下四个条件，那么我们可以称 B 为 A 的莫尔——彭多斯逆

![微信图片_20220907195606.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E5%25BE%25AE%25E4%25BF%25A1%25E5%259B%25BE%25E7%2589%2587_20220907195606.png)

计算矩阵的伪逆：

![微信图片_20220907200222.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E5%25BE%25AE%25E4%25BF%25A1%25E5%259B%25BE%25E7%2589%2587_20220907200222.png)

### 3.7  对于超定方程：***Ax*** = ***b*** 且 **A ****不可逆时，我们通常计算最小二乘解：***x*** = arg min∥**Ax** − **b**∥。线性方程的最小二乘解在代数意义上是可以解析地写出来的。请回答以下小问题：

### (a)  在 ***b*** 非零时，***x*** 的解是什么形式？事实上，我们可以对 ***A*** 求奇异值或对于 ***A***T***A*** 求特征值。请阐述两者之间的关系。

当 b 非零时，原方程可变换成求解非齐次线性方程组，则会出现以下几种可能性：

如果增广矩阵的阶梯型出现 0=常数 的不成立等式，则方程组无解；
如果他的秩小于方程组未知数的个数，则方程组有无穷多个解
如果他的秩等于方程组未知量的个数，则方程组有唯一解，解就是化简的增广矩阵最后一列。

特征值和奇异值的关系：对于非奇异矩阵进行奇异值分解（SVD），得到的奇异值其实就是特征值。对于奇异矩阵，就需要进行奇异值分解，对应奇异值。对于奇异矩阵，从A^T A得到一个方阵，再求特征值。

### (b)  当 ***b*** = **0** 时，我们希望求 ***x*** 的非零解。请说明如何求解 ***x***。

当秩小于未知数个数时，原方程有非零解，然后将系数矩阵 A 化为行最简形矩阵，并写出通解方程组；选取合适的未知自由量，并取出相应的基本向量组，代入通解方程组，得到原方程组的基础解系，进而写出通解。

### (c)请谈谈你对上述解法在几何意义上的理解。该问题为开放问题。

最小二乘解感觉是在方程无解的时候找到一个最近似的解，也即当向量 A、B 无法表示出向量 C 时，需要用 A、B 表示出一个与 C 最近似的向量，则可以用向量 C 向 A、B 所能表示出的区域做投影 D，则可得一个新的向量 W = C - D，那么想要找到最近似向量 C 的向量 D，只需要使向量 W 的模最小即可

### 4.1  说明一个激光传感器下的看到的点应该如何计算它的世界坐标。

设立坐标的转换关系公式并求出即可

![微信图片_20220907225555.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E5%25BE%25AE%25E4%25BF%25A1%25E5%259B%25BE%25E7%2589%2587_20220907225555.png)

![微信图片_20220907225559.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E5%25BE%25AE%25E4%25BF%25A1%25E5%259B%25BE%25E7%2589%2587_20220907225559.png)

### 4.2  取：***q**WR* = [0*.*55*,* 0*.*3*,* 0*.*2*,* 0*.*2]*, **t**W R* = [0*.*1*,* 0*.*2*,* 0*.*3]*T*，***q**RB* = [0*.*99*,* 0*,* 0*,* 0*.*01]*, **t**RB* = [0*.*05*,* 0*,* 0*.*5]*T*，***q**BL* = [0*.*3*,* 0*.*5*,* 0*,* 20*.*1]*, **t**BL* = [0*.*4*,* 0*,* 0*.*5]*T* , ***q**BC* = [0*.*8*,* 0*.*2*,* 0*.*1*,* 0*.*1]*, **t**BC* = [0*.*5*,* 0*.*1*,* 0*.*5]*T*。现在假设相机传感器观察到自身坐标系下的点 [0*.*3*,* 0*.*2*,* 1*.*2]，请计算：(a)这个点在激光系下的坐标；(b)这个点在世界系下的坐标。

![无标题777.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598777.png)

### 5.1  设有旋转矩阵 ***R***，证明 ***R**T **R*** = ***I*** 且 det ***R*** = +1。

思路：向量点积满足交换律

![无标题111.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598111.png)

![无标题111.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598111%201.png)

### 5.2  设有四元数 ***q***，我们把虚部记为 ***ε***，实部记为 *η*，那么 ***q*** = (***ε**, η*)。请说明 ***ε*** 和 *η* 的维度。

四元数的实部 η 是一维，虚部 ε 是三维

### 5.3  请证明对任意单位四元数 ***q***1, ***q***2，四元数乘法可写成矩阵乘法：***q***1***q***2 = ***q***1+***q***2 或者 ***q***1***q***2 = ***q***2*⊕**q***1。

思路：根据四元数运算法则计算即可证明

![无标题222.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598222.png)

![无标题2223.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%25982223.png)

### 6.1  我们在课程中仅指出了罗德里格斯公式成立，但没有给出证明。请你证明此式。提示：参考https://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula。

思路：先将其退化为二维空间的向量分解，再通过旋转这个二维平面获得其在三维空间的向量分解，最后通过向量的加、减、点积、叉积等运算法则并辅以三角函数，求出所有分向量并汇总即可得证

![无标题444.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598444.png)

以上摘抄自维基百科

### 6.2  请使用此式请明 ***R**−*1 = ***R**T*。

思路：由罗德里格斯公式可知，其转置后只会使 sin(θ)K^ 这一项变为相反数，由此得出转置后的结果，又通过罗德里格斯公式旋转思想可知，他的逆就是其向反方向旋转相同角度，那么也能得出只会使sin(θ)K^ 这一项变为相反数的结果，即得证

![无标题555.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598555.png)

### 7  课程中介绍了单位四元数可以表达旋转。其中，在谈论用四元数 ***q*** 旋转点 ***p*** 时，结果为：***p**′* = ***qpq**−*1。我们说，此时 ***p**′* 必定为虚四元数（实部为零）。请你验证上述说法。此外，上式亦可写成矩阵运算：***p**′* = ***Qp***。请根据你的推导，给出矩阵 ***Q***。注意此时 ***p*** 和 ***p**′* 都是四元数形式的变量，所以 ***Q*** 为 4 *×* 4 的矩阵。

思路：四元数运算法则结合矩阵基础运算即可得证

![无标题333.png](%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A%206313d89977f94649bea50673a610a8b2/%25E6%2597%25A0%25E6%25A0%2587%25E9%25A2%2598333.png)

### 8  请说明该程序中哪些地方用到了 C++11 标准的内容。

line17：范围for语句，不用下标就能访问元素；c++11新标准引入的一种更简单的for语句，其语法形式是：

```cpp
for (declaration: expression)
	statement
```

line17：auto 关键字实现自动类型推导，c++11新标准引入，用它就能让编译器替我们去分析表达式所属的类型。

line16： [](const A&a1, const A&a2) {return a1.index<a2.index;}：lambda表达式，一个lambda表达式表示一个可调用的代码单元。我们可以理解为一个未命名的内联函数。于任何函数类似，一个lambda具有一个返回类型、一个参数列表和一个函数体。但与函数不同，lambda可能定义在函数内部。一个lambda表达式具有如下形式：

```cpp
[capture list](parameter list) -> return type {function body}
```

line15：vector<A> avec {a1, a2, a3}; 使用了C++11新标准提出的列表初始化vector对象。用花括号括起来的0个或者多个初始元素值被赋给了avec 这个vector对象。